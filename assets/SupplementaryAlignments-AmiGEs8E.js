const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BreakendSingleLevelOptionDialog-Q8h_pYK6.js","./index-DUxFddIG.js","./index-NjQ7mo-o.css","./FormControlLabel-ClCs1Dm_.js","./Checkbox-B2cvj8Wt.js"])))=>i.map(i=>d[i]);
import{u as m,bg as _,al as b,bh as E,a as y,j as n,T as x,c as $,_ as v,bi as k}from"./index-DUxFddIG.js";import{B as A}from"./BaseCard-Cs055hcc.js";import{L as h}from"./Link-u48G07Rb.js";import{n as B}from"./AlignmentsFeatureDetail-53jlwTan.js";import"./FeatureDetails-1Ex7WWZn.js";import"./FormControlLabel-ClCs1Dm_.js";import"./Checkbox-B2cvj8Wt.js";async function R({view:e,feature:s}){var a;const{assemblyManager:i}=m.getSession(e),r=s.get("CIGAR"),l=s.get("strand"),d=((a=s.get("tags"))===null||a===void 0?void 0:a.SA)||"",u=s.get("name"),t=_(r,1),g=await i.waitForAssembly(e.assemblyNames[0]);if(!g)throw new Error("assembly not found");const p=b(d,s.id(),l,u,!0),o=s.toJSON();o.clipPos=t,o.strand=1,o.mate={refName:u,start:t,end:t+E(r)};const S=[o,...p];for(const[f,c]of S.entries())c.refName=g.getCanonicalRefName(c.refName)||c.refName,c.syntenyId=f,c.mate.syntenyId=f,c.mate.uniqueId=`${c.uniqueId}_mate`;return S.sort((f,c)=>f.clipPos-c.clipPos),S}const C=y.lazy(()=>v(()=>import("./BreakendSingleLevelOptionDialog-Q8h_pYK6.js").then(e=>e.B),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),D=y.lazy(()=>v(()=>import("./BreakendSingleLevelOptionDialog-Q8h_pYK6.js").then(e=>e.a),__vite__mapDeps([0,1,2,3,4]),import.meta.url));function P({model:e,feature:s}){const{view:a}=e,[i,r]=y.useState(),[l,d]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await R({view:a,feature:new m.SimpleFeature(s)});r(t)}catch(t){d(t),console.error(t)}})()},[s,a]);const u=[];if(i)for(let t=0;t<i.length-1;t++)u.push([i[t],i[t+1]]);return u.length?n.jsxs("div",{children:[n.jsx(x,{children:"Launch split view"}),l?n.jsx($.ErrorMessage,{error:l}):null,n.jsx("ul",{children:u.map((t,g)=>{const[p,o]=t;return n.jsxs("li",{children:[p.refName,":",m.toLocale(p.strand===1?p.end:p.start)," ->"," ",o.refName,":",m.toLocale(o.strand===1?o.start:o.end)," ",n.jsx(V,{model:e,f1:p,f2:o})," ",n.jsx(I,{model:e,f1:p,f2:o})]},`${JSON.stringify(t)}-${g}`)})})]}):null}function V({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:i=>{i.preventDefault();const r=m.getSession(e);r.queueDialog(l=>[C,{handleClose:l,session:r,feature:new m.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(top/bottom)"})}function I({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:i=>{i.preventDefault();const r=m.getSession(e);r.queueDialog(l=>[D,{handleClose:l,session:r,feature:new m.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(single row)"})}function O({tag:e,model:s}){return n.jsxs("div",{children:[n.jsx(x,{children:"List of supplementary alignment locations"}),n.jsx("ul",{children:e.split(";").filter(a=>!!a).map((a,i)=>{const[r,l,d,u]=a.split(","),t=k(u),g=Math.floor(t/5),p=+l,o=+l+t,S=p-g,f=o+g,c=`${r}:${Math.max(1,S)}-${f}`,w=p.toLocaleString("en-US"),L=o.toLocaleString("en-US"),j=`${r}:${w}-${L} (${d}) [${t}bp]`;return n.jsx("li",{children:n.jsx(h,{href:"#",onClick:async N=>{N.preventDefault(),B(c,s)},children:j})},`${c}-${i}`)})})]})}function G(e){const{model:s,tag:a,feature:i}=e,r=m.getSession(s),{pluginManager:l}=m.getEnv(r);let d=!1;try{d=!!l.getViewType("BreakpointSplitView")}catch{}return n.jsxs(A,{...e,title:"Supplementary alignments",children:[n.jsx(O,{model:s,tag:a}),d?n.jsx(P,{model:s,feature:i}):null]})}export{G as default};
//# sourceMappingURL=SupplementaryAlignments-AmiGEs8E.js.map
