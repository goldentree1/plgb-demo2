import{aD as F,u as v,o as S,j as u,r as M,d as R}from"./rpcWorker-X0469dqW.js";function A(t,e){var n,i,r,s;const a=e?F(e):void 0,d=t.get("start");let l=t.get("end");const f=t.get("strand"),c=t.get("mate"),m=t.get("refName");let x,p=0,k=0,h=0,b=0;if(["<TRA","<DEL","<INV","<INS","<DUP","<CNV"].some(o=>e==null?void 0:e.startsWith(o))){const o=t.get("INFO"),g=(i=(n=o==null?void 0:o.END)===null||n===void 0?void 0:n[0])!==null&&i!==void 0?i:l;x=(s=(r=o==null?void 0:o.CHR2)===null||r===void 0?void 0:r[0])!==null&&s!==void 0?s:m,p=g,k=g-1,l=d+1}else if(a!=null&&a.MatePosition){const o=a.MatePosition.split(":");b=a.MateDirection==="left"?1:-1,h=a.Join==="left"?-1:1,p=+o[1],k=+o[1]-1,x=o[0]}return{k1:{refName:m,start:d,end:l,strand:f,mateDirection:b},k2:c??{refName:x||"unknown",end:p,start:k,mateDirection:h}}}function T(t,e){var n;const{k1:i,k2:r}=A(t,e);return[t.get("name"),t.get("id"),v.assembleLocString(i),v.assembleLocString(r),(n=t.get("INFO"))===null||n===void 0?void 0:n.SVTYPE,e].filter(s=>!!s).join("<br/>")}const V=M.lazy(()=>import("./ArcTooltip-AKoTaIU3.js")),E=S(function({model:t,feature:e,alt:n,assembly:i,view:r}){var s,a;const[d,l]=M.useState(!1),{height:f}=t,{k1:c,k2:m}=A(e,n),x=M.useRef(null),p=R.getConf(t,"color",{feature:e,alt:n}),k=i.getCanonicalRefName(c.refName)||c.refName,h=i.getCanonicalRefName(m.refName)||m.refName,b=c.start,D=m.start,o=(s=r.bpToPx({refName:k,coord:b}))===null||s===void 0?void 0:s.offsetPx,g=(a=r.bpToPx({refName:h,coord:D}))===null||a===void 0?void 0:a.offsetPx;if(o!==void 0&&g!==void 0){const _=(g-o)/2,C=Math.abs(_),O=Math.min(f,C),$=o-r.offsetPx,w=g-r.offsetPx,N=$,P=w,j=d?"black":p,y=3;return C>1?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:`M ${N} 0 C ${N} ${O}, ${P} ${O}, ${P} 0`,ref:x,...v.getStrokeProps(j),strokeWidth:y,onMouseOut:()=>{l(!1)},onMouseOver:()=>{l(!0)},onClick:()=>{t.selectFeature(e)},fill:"none",pointerEvents:"stroke"}),c.mateDirection?u.jsx("line",{...v.getStrokeProps(j),strokeWidth:y,onMouseOut:()=>{l(!1)},onMouseOver:()=>{l(!0)},onClick:()=>{t.selectFeature(e)},x1:N,x2:N+c.mateDirection*20,y1:1.5,y2:1.5}):null,m.mateDirection?u.jsx("line",{...v.getStrokeProps(j),strokeWidth:y,onMouseOut:()=>{l(!1)},onMouseOver:()=>{l(!0)},onClick:()=>{t.selectFeature(e)},x1:P,x2:P+m.mateDirection*20,y1:1.5,y2:1.5}):null,d?u.jsx(M.Suspense,{fallback:null,children:u.jsx(V,{contents:T(e,n)})}):null]}):null}return null}),W=S(function({model:t,exportSVG:e,children:n}){const{height:i}=t,r=v.getContainingView(t),s=Math.round(r.dynamicBlocks.totalWidthPx);return e?n:u.jsx("svg",{width:s,height:i,children:n})}),L=S(function({model:t,exportSVG:e}){const n=v.getContainingView(t),i=v.getSession(t),{assemblyManager:r}=i,{features:s}=t,a=r.get(n.assemblyNames[0]);return a?u.jsx(W,{model:t,exportSVG:e,children:s==null?void 0:s.map(d=>{var l;const f=d.get("ALT");return(l=f==null?void 0:f.map(c=>u.jsx(E,{session:i,feature:d,alt:c,view:n,model:t,assembly:a},`${d.id()}-${c}`)))!==null&&l!==void 0?l:u.jsx(E,{session:i,feature:d,view:n,model:t,assembly:a},d.id())})}):null});export{L as A};
//# sourceMappingURL=Arcs-DKiHpyXC.js.map
