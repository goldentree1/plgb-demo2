import{B as u}from"./index-D8SKdkWL.js";import{u as l}from"./index-DUxFddIG.js";import{r as c}from"./rxjs-CJV8ZOVO.js";import{m as d,a as p}from"./merge-4GE_4Jvb.js";import"./Observable-m8LxMG-T.js";function o(n){const t=n.slice(n.lastIndexOf("/")+1);return t.slice(0,t.lastIndexOf("."))}function g(n){try{if(n.type==="BigWigAdapter"&&n.bigWigLocation){const t=n.bigWigLocation;if("uri"in t&&t.uri)return o(t.uri);if("localPath"in t&&t.localPath)return o(t.localPath);if("blob"in t&&t.blob){const a=t.blob;return a.name?o(a.name):void 0}}return}catch{return}}class m extends u.BaseFeatureDataAdapter{async getAdapters(){const t=this.getSubAdapter;if(!t)throw new Error("no getSubAdapter available");let a=this.getConf("subadapters");return a!=null&&a.length||(a=this.getConf("bigWigs").map(r=>({type:"BigWigAdapter",source:o(r),bigWigLocation:{uri:r}}))),await Promise.all(a.map(async e=>{const r=(await t(e)).dataAdapter,s=e.source||e.name||g(e)||r.id;return{...e,dataAdapter:r,source:s}}))}async getRefNames(t){const a=await this.getAdapters(),i=await Promise.all(a.map(e=>e.dataAdapter.getRefNames(t)));return[...new Set(i.flat())]}async getGlobalStats(t){const a=await this.getAdapters(),i=(await Promise.all(a.map(e=>{var r,s;return(s=(r=e.dataAdapter).getGlobalStats)===null||s===void 0?void 0:s.call(r,t)}))).filter(e=>!!e);return{scoreMin:l.min(i.map(e=>e.scoreMin)),scoreMax:l.max(i.map(e=>e.scoreMax))}}getFeatures(t,a={}){return c.ObservableCreate(async i=>{const e=await this.getAdapters();d(...e.map(r=>r.dataAdapter.getFeatures(t,a).pipe(p(s=>s.get("source")?s:new l.SimpleFeature({...s.toJSON(),uniqueId:`${r.source}-${s.id()}`,source:r.source}))))).subscribe(i)},a.stopToken)}async getMultiRegionFeatureDensityStats(t){return{featureDensity:0}}async getSources(t){return(await this.getAdapters()).map(({type:i,bigWigLocation:e,dataAdapter:r,...s})=>({...s,name:s.source}))}}m.capabilities=["hasResolution","hasLocalStats","hasGlobalStats"];export{m as default};
//# sourceMappingURL=MultiWiggleAdapter-zaEQKY7U.js.map
