import{r as p,j as s,cf as Te,aH as Ne,b1 as ve,cg as Ie,ch as Ge,ci as Ke,cj as Fe,ck as We,cl as I,cm as ze,cn as qe,co as Ue,as as G,u as T,cp as Je,cq as Ye,cr as Qe,cs as Ce,ct as Xe,U as Me,V as be,c as Ze}from"./rpcWorker-X0469dqW.js";const $e=p.createContext(null);function ee(){return p.useContext($e)}const et=typeof Symbol=="function"&&Symbol.for;var tt=et?Symbol.for("mui.nested"):"__THEME_NESTED__";function ot(e,t){return typeof t=="function"?t(e):{...e,...t}}function st(e){const{children:t,theme:o}=e,n=ee(),c=p.useMemo(()=>{const l=n===null?{...o}:ot(n,o);return l!=null&&(l[tt]=n!==null),l},[o,n]);return s.jsx($e.Provider,{value:c,children:t})}function nt(e){const t=Te(),o=Ne()||"",{modularCssLayers:n}=e;let c="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||t!==null?c="":typeof n=="string"?c=n.replace(/mui(?!\.)/g,c):c=`@layer ${c};`,ve(()=>{var i,d;const l=document.querySelector("head");if(!l)return;const r=l.firstChild;if(c){if(r&&((i=r.hasAttribute)!=null&&i.call(r,"data-mui-layer-order"))&&r.getAttribute("data-mui-layer-order")===o)return;const m=document.createElement("style");m.setAttribute("data-mui-layer-order",o),m.textContent=c,l.prepend(m)}else(d=l.querySelector(`style[data-mui-layer-order="${o}"]`))==null||d.remove()},[c,o]),c?s.jsx(Ie,{styles:c}):null}const je={};function ke(e,t,o,n=!1){return p.useMemo(()=>{const c=e&&t[e]||t;if(typeof o=="function"){const l=o(c),r=e?{...t,[e]:l}:l;return n?()=>r:r}return e?{...t,[e]:o}:{...t,...o}},[e,t,o,n])}function Ee(e){const{children:t,theme:o,themeId:n}=e,c=Te(je),l=ee()||je,r=ke(n,c,o),i=ke(n,l,o,!0),d=(n?r[n]:r).direction==="rtl",m=nt(r);return s.jsx(st,{theme:i,children:s.jsx(Ge.Provider,{value:r,children:s.jsx(Ke,{value:d,children:s.jsxs(Fe,{value:n?r[n].components:r.components,children:[m,t]})})})})}const te="mode",oe="color-scheme",rt="data-color-scheme";function ct(e){const{defaultMode:t="system",defaultLightColorScheme:o="light",defaultDarkColorScheme:n="dark",modeStorageKey:c=te,colorSchemeStorageKey:l=oe,attribute:r=rt,colorSchemeNode:i="document.documentElement",nonce:d}=e||{};let m="",a=r;if(r==="class"&&(a=".%s"),r==="data"&&(a="[data-%s]"),a.startsWith(".")){const x=a.substring(1);m+=`${i}.classList.remove('${x}'.replace('%s', light), '${x}'.replace('%s', dark));
      ${i}.classList.add('${x}'.replace('%s', colorScheme));`}const g=a.match(/\[([^[\]]+)\]/);if(g){const[x,h]=g[1].split("=");h||(m+=`${i}.removeAttribute('${x}'.replace('%s', light));
      ${i}.removeAttribute('${x}'.replace('%s', dark));`),m+=`
      ${i}.setAttribute('${x}'.replace('%s', colorScheme), ${h?`${h}.replace('%s', colorScheme)`:'""'});`}else a!==".%s"&&(m+=`${i}.setAttribute('${a}', colorScheme);`);return s.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?d:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${c}') || '${t}';
  const dark = localStorage.getItem('${l}-dark') || '${n}';
  const light = localStorage.getItem('${l}-light') || '${o}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${m}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function it(){}const lt=({key:e,storageWindow:t})=>(!t&&typeof window<"u"&&(t=window),{get(o){if(typeof window>"u")return;if(!t)return o;let n;try{n=t.localStorage.getItem(e)}catch{}return n||o},set:o=>{if(t)try{t.localStorage.setItem(e,o)}catch{}},subscribe:o=>{if(!t)return it;const n=c=>{const l=c.newValue;c.key===e&&o(l)};return t.addEventListener("storage",n),()=>{t.removeEventListener("storage",n)}}});function Z(){}function we(e){if(typeof window<"u"&&typeof window.matchMedia=="function"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Pe(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function at(e){return Pe(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function dt(e){const{defaultMode:t="light",defaultLightColorScheme:o,defaultDarkColorScheme:n,supportedColorSchemes:c=[],modeStorageKey:l=te,colorSchemeStorageKey:r=oe,storageWindow:i=typeof window>"u"?void 0:window,storageManager:d=lt,noSsr:m=!1}=e,a=c.join(","),g=c.length>1,x=p.useMemo(()=>d==null?void 0:d({key:l,storageWindow:i}),[d,l,i]),h=p.useMemo(()=>d==null?void 0:d({key:`${r}-light`,storageWindow:i}),[d,r,i]),S=p.useMemo(()=>d==null?void 0:d({key:`${r}-dark`,storageWindow:i}),[d,r,i]),[w,j]=p.useState(()=>{const u=(x==null?void 0:x.get(t))||t,y=(h==null?void 0:h.get(o))||o,f=(S==null?void 0:S.get(n))||n;return{mode:u,systemMode:we(u),lightColorScheme:y,darkColorScheme:f}}),[k,L]=p.useState(m||!g);p.useEffect(()=>{L(!0)},[]);const V=at(w),$=p.useCallback(u=>{j(y=>{if(u===y.mode)return y;const f=u??t;return x==null||x.set(f),{...y,mode:f,systemMode:we(f)}})},[x,t]),O=p.useCallback(u=>{u?typeof u=="string"?u&&!a.includes(u)?console.error(`\`${u}\` does not exist in \`theme.colorSchemes\`.`):j(y=>{const f={...y};return Pe(y,C=>{C==="light"&&(h==null||h.set(u),f.lightColorScheme=u),C==="dark"&&(S==null||S.set(u),f.darkColorScheme=u)}),f}):j(y=>{const f={...y},C=u.light===null?o:u.light,_=u.dark===null?n:u.dark;return C&&(a.includes(C)?(f.lightColorScheme=C,h==null||h.set(C)):console.error(`\`${C}\` does not exist in \`theme.colorSchemes\`.`)),_&&(a.includes(_)?(f.darkColorScheme=_,S==null||S.set(_)):console.error(`\`${_}\` does not exist in \`theme.colorSchemes\`.`)),f}):j(y=>(h==null||h.set(o),S==null||S.set(n),{...y,lightColorScheme:o,darkColorScheme:n}))},[a,h,S,o,n]),R=p.useCallback(u=>{w.mode==="system"&&j(y=>{const f=u!=null&&u.matches?"dark":"light";return y.systemMode===f?y:{...y,systemMode:f}})},[w.mode]),H=p.useRef(R);return H.current=R,p.useEffect(()=>{if(typeof window.matchMedia!="function"||!g)return;const u=(...f)=>H.current(...f),y=window.matchMedia("(prefers-color-scheme: dark)");return y.addListener(u),u(y),()=>{y.removeListener(u)}},[g]),p.useEffect(()=>{if(g){const u=(x==null?void 0:x.subscribe(C=>{(!C||["light","dark","system"].includes(C))&&$(C||t)}))||Z,y=(h==null?void 0:h.subscribe(C=>{(!C||a.match(C))&&O({light:C})}))||Z,f=(S==null?void 0:S.subscribe(C=>{(!C||a.match(C))&&O({dark:C})}))||Z;return()=>{u(),y(),f()}}},[O,$,a,t,i,g,x,h,S]),{...w,mode:k?w.mode:void 0,systemMode:k?w.systemMode:void 0,colorScheme:k?V:void 0,setMode:$,setColorScheme:O}}const mt="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function ht(e){const{themeId:t,theme:o={},modeStorageKey:n=te,colorSchemeStorageKey:c=oe,disableTransitionOnChange:l=!1,defaultColorScheme:r,resolveTheme:i}=e,d={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},m=p.createContext(void 0),a=()=>p.useContext(m)||d,g={},x={};function h(k){var xe,Se,ge,pe;const{children:L,theme:V,modeStorageKey:$=n,colorSchemeStorageKey:O=c,disableTransitionOnChange:R=l,storageManager:H,storageWindow:u=typeof window>"u"?void 0:window,documentNode:y=typeof document>"u"?void 0:document,colorSchemeNode:f=typeof document>"u"?void 0:document.documentElement,disableNestedContext:C=!1,disableStyleSheetGeneration:_=!1,defaultMode:Oe="system",forceThemeRerender:Ae=!1,noSsr:Ve}=k,q=p.useRef(!1),U=ee(),J=p.useContext(m),Y=!!J&&!C,se=p.useMemo(()=>V||(typeof o=="function"?o():o),[V]),ne=se[t],v=ne||se,{colorSchemes:B=g,components:re=x,cssVarPrefix:Q}=v,ce=Object.keys(B).filter(M=>!!B[M]).join(","),N=p.useMemo(()=>ce.split(","),[ce]),ie=typeof r=="string"?r:r.light,le=typeof r=="string"?r:r.dark,Be=B[ie]&&B[le]?Oe:((Se=(xe=B[v.defaultColorScheme])==null?void 0:xe.palette)==null?void 0:Se.mode)||((ge=v.palette)==null?void 0:ge.mode),{mode:Re,setMode:ae,systemMode:de,lightColorScheme:me,darkColorScheme:he,colorScheme:_e,setColorScheme:ue}=dt({supportedColorSchemes:N,defaultLightColorScheme:ie,defaultDarkColorScheme:le,modeStorageKey:$,colorSchemeStorageKey:O,defaultMode:Be,storageManager:H,storageWindow:u,noSsr:Ve});let X=Re,E=_e;Y&&(X=J.mode,E=J.colorScheme);let W=E||v.defaultColorScheme;v.vars&&!Ae&&(W=v.defaultColorScheme);const K=p.useMemo(()=>{var D;const M=((D=v.generateThemeVars)==null?void 0:D.call(v))||v.vars,b={...v,components:re,colorSchemes:B,cssVarPrefix:Q,vars:M};if(typeof b.generateSpacing=="function"&&(b.spacing=b.generateSpacing()),W){const A=B[W];A&&typeof A=="object"&&Object.keys(A).forEach(P=>{A[P]&&typeof A[P]=="object"?b[P]={...b[P],...A[P]}:b[P]=A[P]})}return i?i(b):b},[v,W,re,B,Q]),F=v.colorSchemeSelector;ve(()=>{if(E&&f&&F&&F!=="media"){const M=F;let b=F;if(M==="class"&&(b=".%s"),M==="data"&&(b="[data-%s]"),M!=null&&M.startsWith("data-")&&!M.includes("%s")&&(b=`[${M}="%s"]`),b.startsWith("."))f.classList.remove(...N.map(D=>b.substring(1).replace("%s",D))),f.classList.add(b.substring(1).replace("%s",E));else{const D=b.replace("%s",E).match(/\[([^\]]+)\]/);if(D){const[A,P]=D[1].split("=");P||N.forEach(He=>{f.removeAttribute(A.replace(E,He))}),f.setAttribute(A,P?P.replace(/"|'/g,""):"")}else f.setAttribute(b,E)}}},[E,F,f,N]),p.useEffect(()=>{let M;if(R&&q.current&&y){const b=y.createElement("style");b.appendChild(y.createTextNode(mt)),y.head.appendChild(b),window.getComputedStyle(y.body),M=setTimeout(()=>{y.head.removeChild(b)},1)}return()=>{clearTimeout(M)}},[E,R,y]),p.useEffect(()=>(q.current=!0,()=>{q.current=!1}),[]);const De=p.useMemo(()=>({allColorSchemes:N,colorScheme:E,darkColorScheme:he,lightColorScheme:me,mode:X,setColorScheme:ue,setMode:ae,systemMode:de}),[N,E,he,me,X,ue,ae,de,K.colorSchemeSelector]);let fe=!0;(_||v.cssVariables===!1||Y&&(U==null?void 0:U.cssVarPrefix)===Q)&&(fe=!1);const ye=s.jsxs(p.Fragment,{children:[s.jsx(Ee,{themeId:ne?t:void 0,theme:K,children:L}),fe&&s.jsx(We,{styles:((pe=K.generateStyleSheets)==null?void 0:pe.call(K))||[]})]});return Y?ye:s.jsx(m.Provider,{value:De,children:ye})}const S=typeof r=="string"?r:r.light,w=typeof r=="string"?r:r.dark;return{CssVarsProvider:h,useColorScheme:a,getInitColorSchemeScript:k=>ct({colorSchemeStorageKey:c,defaultLightColorScheme:S,defaultDarkColorScheme:w,modeStorageKey:n,...k})}}function ut({theme:e,...t}){const o=I in e?e[I]:void 0;return s.jsx(Ee,{...t,themeId:o?I:void 0,theme:o||e})}const z={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:ft}=ht({themeId:I,theme:()=>Ue({cssVariables:!0}),colorSchemeStorageKey:z.colorSchemeStorageKey,modeStorageKey:z.modeStorageKey,defaultColorScheme:{light:z.defaultLightColorScheme,dark:z.defaultDarkColorScheme},resolveTheme:e=>{const t={...e,typography:ze(e.palette,e.typography)};return t.unstable_sx=function(n){return qe({sx:n,theme:this})},t}}),yt=ft;function xt({theme:e,...t}){const o=p.useMemo(()=>{if(typeof e=="function")return e;const n=I in e?e[I]:e;return"colorSchemes"in n?null:"vars"in n?e:{...e,vars:null}},[e]);return o?s.jsx(ut,{theme:o,...t}):s.jsx(yt,{theme:e,...t})}function St({width:e,height:t,shift:o}){const n=G();return s.jsx("rect",{width:e+o*2,height:t,fill:T.stripAlpha(n.palette.background.default)})}function Le({model:e,height:t}){const{dynamicBlocks:o,offsetPx:n,interRegionPaddingWidth:c}=e;return s.jsx(s.Fragment,{children:o.contentBlocks.slice(1).map(l=>s.jsx("rect",{x:l.offsetPx-n-c,width:c,y:0,height:t,fill:"grey"},l.key))})}function gt({start:e,end:t,bpPerPx:o,reversed:n=!1,major:c=!0,minor:l=!0,hideText:r=!1}){const i=Je(e,t,o,c,l),d=G(),m=T.stripAlpha(d.palette.text.secondary);return s.jsxs(s.Fragment,{children:[i.map(a=>{const g=(n?t-a.base:a.base-e)/o;return s.jsx("line",{x1:g,x2:g,y1:0,y2:a.type==="major"?6:4,strokeWidth:1,stroke:m},`tick-${a.base}`)}),r?null:i.filter(a=>a.type==="major").map(a=>{const g=(n?t-a.base:a.base-e)/o;return s.jsx("text",{x:g-3,y:18,fontSize:11,fill:m,children:T.getTickDisplayStr(a.base+1,o)},`label-${a.base}`)})]})}function pt({model:e,fontSize:t}){const{dynamicBlocks:{contentBlocks:o},offsetPx:n,bpPerPx:c}=e,l=o.length<5,r=G(),i=T.stripAlpha(r.palette.text.primary);return s.jsxs(s.Fragment,{children:[s.jsx(Le,{model:e,height:30}),o.map(d=>{const{start:m,end:a,key:g,reversed:x,offsetPx:h,refName:S,widthPx:w}=d,j=h-n,k=`clip-${g}`;return s.jsxs("g",{children:[s.jsx("defs",{children:s.jsx("clipPath",{id:k,children:s.jsx("rect",{x:0,y:0,width:w,height:100})})}),s.jsx("g",{transform:`translate(${j} 0)`,children:s.jsxs("g",{clipPath:`url(#${k})`,children:[s.jsx("text",{x:4,y:t,fontSize:t,fill:i,children:S}),s.jsx("g",{transform:"translate(0 20)",children:s.jsx(gt,{hideText:!l,start:m,end:a,bpPerPx:c,reversed:x})})]})})]},g)})]})}function Ct({model:e,fontSize:t}){const{offsetPx:o,dynamicBlocks:{totalWidthPxWithoutBorders:n,totalBp:c}}=e,l=G(),r=T.getBpDisplayStr(c),i=Math.max(-o,0),d=i+n,m=T.stripAlpha(l.palette.text.secondary),a=i+(d-i)/2,g=t;return s.jsxs(s.Fragment,{children:[s.jsx("line",{x1:i,x2:d,y1:10,y2:10,stroke:m}),s.jsx("line",{x1:i,x2:i,y1:5,y2:15,stroke:m}),s.jsx("line",{x1:d,x2:d,y1:5,y2:15,stroke:m}),s.jsx("text",{x:a,y:g,textAnchor:"middle",dominantBaseline:"hanging",fontSize:t,fill:m,children:r})]})}function bt({model:e,fontSize:t,cytobandHeight:o,rulerHeight:n}){const{width:c,assemblyNames:l,showCytobands:r,displayedRegions:i}=e,{assemblyManager:d}=T.getSession(e),m=l.length>1?"":l[0],a=d.get(m),g=G(),x=T.stripAlpha(g.palette.text.primary),h=Ye.create({displayedRegions:JSON.parse(JSON.stringify(i)),interRegionPaddingWidth:0,minimumBlockWidth:e.minimumBlockWidth}),S=e.dynamicBlocks.contentBlocks;if(!S.length)return null;h.setVolatileWidth(c),h.showAllRegions();const w=h.dynamicBlocks.contentBlocks[0],j=S.at(0),k=S.at(-1),L=h.bpToPx({...j,coord:j.reversed?j.end:j.start})||0,V=h.bpToPx({...k,coord:k.reversed?k.start:k.end})||0,$=+r*o;return s.jsxs("g",{id:"header",children:[s.jsx("text",{x:0,y:0,dominantBaseline:"hanging",fontSize:t,fill:x,children:m}),r?s.jsxs("g",{transform:`translate(0 ${n})`,children:[s.jsx(Qe,{overview:h,assembly:a,block:w}),s.jsx("rect",{stroke:"red",fill:"rgb(255,0,0)",fillOpacity:.1,width:Math.max(V-L,.5),height:Ce-1,x:L,y:.5}),s.jsx("g",{transform:`translate(0,${Ce})`,children:s.jsx(Xe,{overview:h,model:e,useOffset:!1})})]}):null,s.jsx("g",{transform:`translate(0 ${t+$})`,children:s.jsx(Ct,{model:e,fontSize:t})}),s.jsx("g",{transform:`translate(0 ${n+$})`,children:s.jsx(pt,{model:e,fontSize:t})})]})}function jt({trackLabels:e,trackName:t,fontSize:o,trackLabelOffset:n,x:c}){const l=G(),r=T.stripAlpha(l.palette.text.primary),i=e==="overlay"?5:0,d=e==="offset"?5:0,m=T.coarseStripHTML(t);return e!=="none"?s.jsx("g",{children:e==="left"?s.jsx("text",{x:n-40,y:20,fill:r,fontSize:o,dominantBaseline:"hanging",textAnchor:"end",children:m}):s.jsx("text",{x:c+i,y:d,fill:r,fontSize:o,dominantBaseline:"hanging",children:m})}):null}function kt({displayResults:e,model:t,textHeight:o,fontSize:n,trackLabels:c="offset",trackLabelOffset:l=0}){const r=T.getSession(t),i=c==="offset"?o:0;return s.jsx(s.Fragment,{children:e.reduce(({prevOffset:d,reactElements:m},{track:a,result:g})=>{const x=a.configuration,h=Me.getTrackName(x,r),S=a.displays[0],w=Math.max(-t.offsetPx,0);return{prevOffset:d+S.height+i,reactElements:[...m,s.jsxs("g",{transform:`translate(0 ${d})`,children:[s.jsxs("g",{transform:`translate(${l} ${i})`,children:[s.jsx(Le,{model:t,height:S.height}),g]}),s.jsx(jt,{trackName:h,fontSize:n,trackLabels:c,trackLabelOffset:l,x:w})]},x.trackId)]}},{prevOffset:0,reactElements:[]}).reactElements})}function wt(e,t,o){return T.sum(e.map(n=>n.displays[0].height+(["none","left"].includes(o)?0:t)))}async function vt(e,t){await be(()=>e.initialized);const{textHeight:o=18,headerHeight:n=40,rulerHeight:c=50,fontSize:l=13,cytobandHeight:r=100,trackLabels:i="offset",themeName:d="default",Wrapper:m=({children:f})=>f}=t,a=T.getSession(e),{allThemes:g}=a,x=g==null?void 0:g()[d],{width:h,pinnedTracks:S,unpinnedTracks:w,tracks:j,showCytobands:k}=e,L=50,V=+k*r,$=n+c+V+10,O=wt(j,o,i)+$+100,R=await Promise.all([...S,...w].map(async f=>{const C=f.displays[0];return await be(()=>!C.renderProps().notReady),{track:f,result:await C.renderSvg({...t,theme:x})}})),H=T.max(j.map(f=>T.measureText(Me.getTrackName(f.configuration,a),l)),0)+40,u=i==="left"?H:0,y=h+u;return T.renderToStaticMarkup(s.jsx(xt,{theme:Ze.createJBrowseTheme(x),children:s.jsx(m,{children:s.jsxs("svg",{width:y,height:O,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,y+L*2,O].toString(),children:[s.jsx(St,{width:y,height:O,shift:L}),s.jsxs("g",{transform:`translate(${L} 0)`,children:[s.jsx("g",{transform:`translate(${u})`,children:s.jsx(bt,{model:e,fontSize:l,rulerHeight:c,cytobandHeight:r})}),s.jsx("g",{transform:`translate(0 ${$})`,children:s.jsx(kt,{textHeight:o,fontSize:l,model:e,displayResults:R,trackLabels:i,trackLabelOffset:u})})]})]})})}))}export{pt as SVGRuler,kt as SVGTracks,vt as renderToSvg};
//# sourceMappingURL=SVGLinearGenomeView-BjFmJHUI.js.map
