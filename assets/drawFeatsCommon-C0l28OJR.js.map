{"version":3,"file":"drawFeatsCommon-C0l28OJR.js","sources":["../../node_modules/@jbrowse/plugin-alignments/esm/shared/canvasUtils.js","../../node_modules/@jbrowse/plugin-alignments/esm/shared/chevron.js","../../node_modules/@jbrowse/plugin-alignments/esm/shared/primaryStrand.js","../../node_modules/@jbrowse/plugin-alignments/esm/shared/drawLongReadChains.js","../../node_modules/@jbrowse/plugin-alignments/esm/shared/drawPairChains.js","../../node_modules/@jbrowse/plugin-alignments/esm/LinearReadCloudDisplay/drawFeatsCommon.js"],"sourcesContent":["export function fillRectCtx(x, y, width, height, ctx, fillColor) {\n    if (width < 0) {\n        x += width;\n        width = -width;\n    }\n    if (height < 0) {\n        y += height;\n        height = -height;\n    }\n    if (fillColor) {\n        ctx.fillStyle = fillColor;\n    }\n    ctx.fillRect(x, y, width, height);\n}\nexport function strokeRectCtx(x, y, width, height, ctx, strokeColor) {\n    if (width < 0) {\n        x += width;\n        width = -width;\n    }\n    if (height < 0) {\n        y += height;\n        height = -height;\n    }\n    if (strokeColor) {\n        ctx.strokeStyle = strokeColor;\n    }\n    ctx.strokeRect(x, y, width, height);\n}\n","export function drawChevron(ctx, x, y, width, height, strand, color, chevronWidth, stroke) {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    if (strand === -1) {\n        ctx.moveTo(x - chevronWidth, y + height / 2);\n        ctx.lineTo(x, y + height);\n        ctx.lineTo(x + width, y + height);\n        ctx.lineTo(x + width, y);\n        ctx.lineTo(x, y);\n    }\n    else {\n        ctx.moveTo(x, y);\n        ctx.lineTo(x, y + height);\n        ctx.lineTo(x + width, y + height);\n        ctx.lineTo(x + width + chevronWidth, y + height / 2);\n        ctx.lineTo(x + width, y);\n    }\n    ctx.closePath();\n    ctx.fill();\n    if (stroke) {\n        ctx.strokeStyle = stroke;\n        ctx.stroke();\n    }\n}\n","export function getPrimaryStrand(feat) {\n    var _a, _b;\n    if (!(feat.flags & 2048)) {\n        return feat.strand;\n    }\n    else {\n        const res = (_b = (_a = feat.SA) === null || _a === void 0 ? void 0 : _a.split(';')[0]) === null || _b === void 0 ? void 0 : _b.split(',')[2];\n        return res === '-' ? -1 : 1;\n    }\n}\nexport function getPrimaryStrandFromFlags(feat) {\n    var _a, _b;\n    if (!(feat.flags & 2048)) {\n        return feat.flags & 16 ? -1 : 1;\n    }\n    else {\n        const res = (_b = (_a = feat.SA) === null || _a === void 0 ? void 0 : _a.split(';')[0]) === null || _b === void 0 ? void 0 : _b.split(',')[2];\n        return res === '-' ? -1 : 1;\n    }\n}\n","import { fillRectCtx, strokeRectCtx } from './canvasUtils';\nimport { drawChevron } from './chevron';\nimport { fillColor, getSingletonColor, strokeColor } from './color';\nimport { getPrimaryStrandFromFlags } from './primaryStrand';\nimport { CHEVRON_WIDTH } from './util';\nexport function drawLongReadChains({ ctx, chainData, view, asm, chainYOffsets, renderChevrons, featureHeight, featuresForFlatbush, computedChains, flipStrandLongReadChains, }) {\n    var _a, _b;\n    const getStrandColorKey = (strand) => strand === -1 ? 'color_rev_strand' : 'color_fwd_strand';\n    for (const computedChain of computedChains) {\n        const { id, chain, minX, maxX } = computedChain;\n        let isPairedEnd = false;\n        for (const element of chain) {\n            if (element.flags & 1) {\n                isPairedEnd = true;\n                break;\n            }\n        }\n        if (isPairedEnd) {\n            continue;\n        }\n        const chainY = chainYOffsets.get(id);\n        if (chainY === undefined) {\n            continue;\n        }\n        const nonSupplementary = [];\n        for (const element of chain) {\n            if (!(element.flags & 2048)) {\n                nonSupplementary.push(element);\n            }\n        }\n        const isSingleton = chain.length === 1;\n        const c1 = nonSupplementary[0] || chain[0];\n        const primaryStrand = getPrimaryStrandFromFlags(c1);\n        if (!isSingleton) {\n            const firstFeat = chain[0];\n            const lastFeat = chain[chain.length - 1];\n            const firstPx = (_a = view.bpToPx({\n                refName: asm.getCanonicalRefName2(firstFeat.refName),\n                coord: firstFeat.start,\n            })) === null || _a === void 0 ? void 0 : _a.offsetPx;\n            const lastPx = (_b = view.bpToPx({\n                refName: asm.getCanonicalRefName2(lastFeat.refName),\n                coord: lastFeat.end,\n            })) === null || _b === void 0 ? void 0 : _b.offsetPx;\n            if (firstPx !== undefined && lastPx !== undefined) {\n                const lineY = chainY + featureHeight / 2 - 0.5;\n                ctx.beginPath();\n                ctx.strokeStyle = '#666';\n                ctx.moveTo(firstPx - view.offsetPx, lineY);\n                ctx.lineTo(lastPx - view.offsetPx, lineY);\n                ctx.stroke();\n            }\n        }\n        const viewOffsetPx = view.offsetPx;\n        const chainMinXPx = minX - viewOffsetPx;\n        const chainMaxXPx = maxX - viewOffsetPx;\n        for (let i = 0, l = chain.length; i < l; i++) {\n            const feat = chain[i];\n            const s = view.bpToPx({\n                refName: asm.getCanonicalRefName2(feat.refName),\n                coord: feat.start,\n            });\n            const e = view.bpToPx({\n                refName: asm.getCanonicalRefName2(feat.refName),\n                coord: feat.end,\n            });\n            if (!s || !e) {\n                continue;\n            }\n            const effectiveStrand = isSingleton || !flipStrandLongReadChains\n                ? feat.strand\n                : feat.strand * primaryStrand;\n            const [featureFill, featureStroke] = isSingleton\n                ? getSingletonColor(feat, chainData.stats)\n                : [\n                    fillColor[getStrandColorKey(effectiveStrand)],\n                    strokeColor[getStrandColorKey(effectiveStrand)],\n                ];\n            const xPos = s.offsetPx - viewOffsetPx;\n            const width = Math.max(e.offsetPx - s.offsetPx, 3);\n            if (renderChevrons) {\n                drawChevron(ctx, xPos, chainY, width, featureHeight, effectiveStrand, featureFill, CHEVRON_WIDTH, featureStroke);\n            }\n            else {\n                fillRectCtx(xPos, chainY, width, featureHeight, ctx, featureFill);\n                strokeRectCtx(xPos, chainY, width, featureHeight, ctx, featureStroke);\n            }\n            featuresForFlatbush.push({\n                x1: xPos,\n                y1: chainY,\n                x2: xPos + width,\n                y2: chainY + featureHeight,\n                data: feat,\n                chainId: id,\n                chainMinX: chainMinXPx,\n                chainMaxX: chainMaxXPx,\n                chain,\n            });\n        }\n    }\n}\n","import { fillRectCtx, strokeRectCtx } from './canvasUtils';\nimport { drawChevron } from './chevron';\nimport { getPairedColor, getSingletonColor } from './color';\nimport { CHEVRON_WIDTH } from './util';\nexport function drawPairChains({ ctx, type, chainData, view, asm, chainYOffsets, renderChevrons, featureHeight, featuresForFlatbush, computedChains, }) {\n    var _a, _b;\n    for (const computedChain of computedChains) {\n        const { id, chain, minX, maxX } = computedChain;\n        let isPairedEnd = false;\n        for (const element of chain) {\n            if (element.flags & 1) {\n                isPairedEnd = true;\n                break;\n            }\n        }\n        if (!isPairedEnd) {\n            continue;\n        }\n        const chainY = chainYOffsets.get(id);\n        if (chainY === undefined) {\n            continue;\n        }\n        const nonSupplementary = [];\n        for (const element of chain) {\n            if (!(element.flags & 2048)) {\n                nonSupplementary.push(element);\n            }\n        }\n        const hasBothMates = nonSupplementary.length === 2;\n        const [pairedFill, pairedStroke] = hasBothMates\n            ? getPairedColor({\n                type,\n                v0: nonSupplementary[0],\n                v1: nonSupplementary[1],\n                stats: chainData.stats,\n            }) || ['#888', '#888']\n            : getSingletonColor(nonSupplementary[0] || chain[0], chainData.stats);\n        if (hasBothMates) {\n            const v0 = nonSupplementary[0];\n            const v1 = nonSupplementary[1];\n            const r1s = (_a = view.bpToPx({\n                refName: asm.getCanonicalRefName2(v0.refName),\n                coord: v0.start,\n            })) === null || _a === void 0 ? void 0 : _a.offsetPx;\n            const r2s = (_b = view.bpToPx({\n                refName: asm.getCanonicalRefName2(v1.refName),\n                coord: v1.start,\n            })) === null || _b === void 0 ? void 0 : _b.offsetPx;\n            if (r1s !== undefined && r2s !== undefined) {\n                fillRectCtx(r1s - view.offsetPx, chainY + featureHeight / 2 - 0.5, r2s - r1s, 1, ctx, '#666');\n            }\n        }\n        const viewOffsetPx = view.offsetPx;\n        const chainMinXPx = minX - viewOffsetPx;\n        const chainMaxXPx = maxX - viewOffsetPx;\n        for (let i = 0, l = chain.length; i < l; i++) {\n            const feat = chain[i];\n            const s = view.bpToPx({\n                refName: asm.getCanonicalRefName2(feat.refName),\n                coord: feat.start,\n            });\n            const e = view.bpToPx({\n                refName: asm.getCanonicalRefName2(feat.refName),\n                coord: feat.end,\n            });\n            if (!s || !e) {\n                continue;\n            }\n            const xPos = s.offsetPx - viewOffsetPx;\n            const width = Math.max(e.offsetPx - s.offsetPx, 3);\n            if (renderChevrons) {\n                drawChevron(ctx, xPos, chainY, width, featureHeight, feat.strand, pairedFill, CHEVRON_WIDTH, pairedStroke);\n            }\n            else {\n                fillRectCtx(xPos, chainY, width, featureHeight, ctx, pairedFill);\n                strokeRectCtx(xPos, chainY, width, featureHeight, ctx, pairedStroke);\n            }\n            featuresForFlatbush.push({\n                x1: xPos,\n                y1: chainY,\n                x2: xPos + width,\n                y2: chainY + featureHeight,\n                data: feat,\n                chainId: id,\n                chainMinX: chainMinXPx,\n                chainMaxX: chainMaxXPx,\n                chain,\n            });\n        }\n    }\n}\n","import { getConf } from '@jbrowse/core/configuration';\nimport { getContainingView, getSession } from '@jbrowse/core/util';\nimport Flatbush from '@jbrowse/core/util/flatbush';\nimport { PairType, getPairedType } from '../shared/color';\nimport { drawLongReadChains } from '../shared/drawLongReadChains';\nimport { drawPairChains } from '../shared/drawPairChains';\nimport { shouldRenderChevrons } from '../shared/util';\nexport function filterChains(chains, drawSingletons, drawProperPairs, type, chainData) {\n    const filtered = [];\n    for (const chain_ of chains) {\n        const chain = chain_;\n        if (!drawSingletons && chain.length === 1) {\n            continue;\n        }\n        let isPairedEnd = false;\n        for (const element of chain) {\n            if (element.flags & 1) {\n                isPairedEnd = true;\n                break;\n            }\n        }\n        if (!drawProperPairs && isPairedEnd) {\n            const nonSupplementary = [];\n            for (const element of chain) {\n                if (!(element.flags & 2048)) {\n                    nonSupplementary.push(element);\n                }\n            }\n            if (nonSupplementary.length === 2) {\n                const v0 = nonSupplementary[0];\n                const v1 = nonSupplementary[1];\n                const pairType = getPairedType({\n                    type,\n                    f1: v0,\n                    f2: v1,\n                    stats: chainData.stats,\n                });\n                if (pairType === PairType.PROPER_PAIR) {\n                    continue;\n                }\n            }\n        }\n        filtered.push(chain);\n    }\n    return filtered;\n}\nexport function computeChainBounds(chains, view, asm) {\n    var _a, _b;\n    const computedChains = [];\n    for (const chain_ of chains) {\n        const chain = chain_;\n        let minX = Number.MAX_VALUE;\n        let maxX = Number.MIN_VALUE;\n        let chainId = '';\n        let tlenDistance = 0;\n        const chainLength = chain.length;\n        for (let j = 0; j < chainLength; j++) {\n            const elt = chain[j];\n            const refName = asm.getCanonicalRefName(elt.refName) || elt.refName;\n            const rs = (_a = view.bpToPx({ refName, coord: elt.start })) === null || _a === void 0 ? void 0 : _a.offsetPx;\n            const re = (_b = view.bpToPx({ refName, coord: elt.end })) === null || _b === void 0 ? void 0 : _b.offsetPx;\n            if (rs !== undefined && re !== undefined) {\n                minX = Math.min(minX, rs);\n                maxX = Math.max(maxX, re);\n            }\n            if (!chainId) {\n                chainId = elt.id;\n            }\n            if (chainLength > 1 && tlenDistance === 0 && elt.tlen) {\n                tlenDistance = Math.abs(elt.tlen);\n            }\n        }\n        const distance = tlenDistance > 0 ? tlenDistance : Math.abs(maxX - minX);\n        computedChains.push({\n            distance,\n            minX,\n            maxX,\n            chain,\n            id: chainId,\n        });\n    }\n    return computedChains;\n}\nexport function sortComputedChains(computedChains) {\n    computedChains.sort((a, b) => {\n        const aIsSingleton = a.chain.length === 1 ? 1 : 0;\n        const bIsSingleton = b.chain.length === 1 ? 1 : 0;\n        if (bIsSingleton !== aIsSingleton) {\n            return bIsSingleton - aIsSingleton;\n        }\n        return a.distance - b.distance;\n    });\n}\nexport function buildFlatbushIndex(featuresForFlatbush, self) {\n    const finalFlatbush = new Flatbush(Math.max(featuresForFlatbush.length, 1));\n    const length = featuresForFlatbush.length;\n    if (length) {\n        for (let i = 0; i < length; i++) {\n            const { x1, y1, x2, y2 } = featuresForFlatbush[i];\n            finalFlatbush.add(x1, y1, x2, y2);\n        }\n    }\n    else {\n        finalFlatbush.add(0, 0);\n    }\n    finalFlatbush.finish();\n    self.setFeatureLayout(finalFlatbush);\n    self.setFeaturesForFlatbush(featuresForFlatbush);\n}\nexport function addChainMouseoverRects(computedChains, chainYOffsets, featureHeight, view, featuresForFlatbush) {\n    for (const computedChain of computedChains) {\n        const { id, chain, minX, maxX } = computedChain;\n        const chainY = chainYOffsets.get(id);\n        if (chainY === undefined) {\n            continue;\n        }\n        const chainMinXPx = minX - view.offsetPx;\n        const chainMaxXPx = maxX - view.offsetPx;\n        if (chain.length > 0) {\n            featuresForFlatbush.push({\n                x1: chainMinXPx,\n                y1: chainY,\n                x2: chainMaxXPx,\n                y2: chainY + featureHeight,\n                data: chain[0],\n                chainId: id,\n                chainMinX: chainMinXPx,\n                chainMaxX: chainMaxXPx,\n                chain,\n            });\n        }\n    }\n}\nexport function drawFeatsCommon(self, ctx, calculateYOffsets) {\n    var _a, _b;\n    const { chainData } = self;\n    if (!chainData) {\n        return;\n    }\n    const { assemblyManager } = getSession(self);\n    const view = getContainingView(self);\n    const assemblyName = view.assemblyNames[0];\n    const asm = assemblyManager.get(assemblyName);\n    if (!asm) {\n        return;\n    }\n    const featureHeight = (_a = self.featureHeight) !== null && _a !== void 0 ? _a : getConf(self, 'featureHeight');\n    const type = ((_b = self.colorBy) === null || _b === void 0 ? void 0 : _b.type) || 'insertSizeAndOrientation';\n    const drawSingletons = self.drawSingletons;\n    const drawProperPairs = self.drawProperPairs;\n    const { chains } = chainData;\n    const filteredChains = filterChains(chains, drawSingletons, drawProperPairs, type, chainData);\n    const computedChains = computeChainBounds(filteredChains, view, asm);\n    sortComputedChains(computedChains);\n    const { chainYOffsets, layoutHeight } = calculateYOffsets(computedChains, self, view, featureHeight);\n    const featuresForFlatbush = [];\n    const renderChevrons = shouldRenderChevrons(view.bpPerPx, featureHeight);\n    drawPairChains({\n        ctx,\n        type,\n        chainData,\n        view,\n        asm,\n        chainYOffsets,\n        renderChevrons,\n        featureHeight,\n        featuresForFlatbush,\n        computedChains,\n    });\n    drawLongReadChains({\n        ctx,\n        chainData,\n        view,\n        asm,\n        chainYOffsets,\n        renderChevrons,\n        featureHeight,\n        featuresForFlatbush,\n        computedChains,\n        flipStrandLongReadChains: self.flipStrandLongReadChains,\n    });\n    addChainMouseoverRects(computedChains, chainYOffsets, featureHeight, view, featuresForFlatbush);\n    buildFlatbushIndex(featuresForFlatbush, self);\n    if (layoutHeight !== undefined) {\n        self.setLayoutHeight(layoutHeight);\n    }\n}\n"],"names":["fillRectCtx","x","y","width","height","ctx","fillColor","strokeRectCtx","strokeColor","drawChevron","strand","color","chevronWidth","stroke","getPrimaryStrandFromFlags","feat","_a","_b","drawLongReadChains","chainData","view","asm","chainYOffsets","renderChevrons","featureHeight","featuresForFlatbush","computedChains","flipStrandLongReadChains","getStrandColorKey","computedChain","id","chain","minX","maxX","isPairedEnd","element","chainY","nonSupplementary","isSingleton","c1","primaryStrand","firstFeat","lastFeat","firstPx","lastPx","lineY","viewOffsetPx","chainMinXPx","chainMaxXPx","i","l","s","e","effectiveStrand","featureFill","featureStroke","getSingletonColor","xPos","CHEVRON_WIDTH","drawPairChains","type","hasBothMates","pairedFill","pairedStroke","getPairedColor","v0","v1","r1s","r2s","filterChains","chains","drawSingletons","drawProperPairs","filtered","chain_","getPairedType","PairType","computeChainBounds","chainId","tlenDistance","chainLength","j","elt","refName","rs","re","distance","sortComputedChains","a","b","aIsSingleton","bIsSingleton","buildFlatbushIndex","self","finalFlatbush","Flatbush","length","x1","y1","x2","y2","addChainMouseoverRects","drawFeatsCommon","calculateYOffsets","assemblyManager","getSession","getContainingView","assemblyName","getConf","filteredChains","layoutHeight","shouldRenderChevrons"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}