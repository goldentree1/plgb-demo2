{"version":3,"file":"FilterByTagDialog-ButU_Gth.js","sources":["../../node_modules/@jbrowse/plugin-alignments/esm/shared/components/FilterByTagDialog.js"],"sourcesContent":["import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Dialog } from '@jbrowse/core/ui';\nimport { Button, DialogActions, DialogContent, Link, Paper, TextField, Typography, } from '@mui/material';\nimport { observer } from 'mobx-react';\nimport { makeStyles } from 'tss-react/mui';\nconst useStyles = makeStyles()(theme => ({\n    paper: {\n        padding: theme.spacing(2),\n        margin: theme.spacing(2),\n    },\n    field: {\n        margin: theme.spacing(2),\n    },\n}));\nconst flagNames = [\n    'read paired',\n    'read mapped in proper pair',\n    'read unmapped',\n    'mate unmapped',\n    'read reverse strand',\n    'mate reverse strand',\n    'first in pair',\n    'second in pair',\n    'not primary alignment',\n    'read fails platform/vendor quality checks',\n    'read is PCR or optical duplicate',\n    'supplementary alignment',\n];\nfunction Bitmask(props) {\n    const { flag = 0, setFlag } = props;\n    return (_jsxs(_Fragment, { children: [_jsx(TextField, { type: \"number\", value: flag, onChange: event => {\n                    setFlag(+event.target.value);\n                } }), flagNames.map((name, index) => {\n                const val = flag & (1 << index);\n                const key = `${name}_${val}`;\n                return (_jsxs(\"div\", { children: [_jsx(\"input\", { type: \"checkbox\", checked: Boolean(val), onChange: event => {\n                                if (event.target.checked) {\n                                    setFlag(flag | (1 << index));\n                                }\n                                else {\n                                    setFlag(flag & ~(1 << index));\n                                }\n                            } }), _jsx(\"label\", { htmlFor: key, children: name })] }, key));\n            })] }));\n}\nconst FilterByTagDialog = observer(function (props) {\n    var _a, _b;\n    const { model, handleClose } = props;\n    const { classes } = useStyles();\n    const { filterBy } = model;\n    const [flagInclude, setFlagInclude] = useState(filterBy.flagInclude);\n    const [flagExclude, setFlagExclude] = useState(filterBy.flagExclude);\n    const [tag, setTag] = useState(((_a = filterBy.tagFilter) === null || _a === void 0 ? void 0 : _a.tag) || '');\n    const [tagValue, setTagValue] = useState(((_b = filterBy.tagFilter) === null || _b === void 0 ? void 0 : _b.value) || '');\n    const [readName, setReadName] = useState(filterBy.readName || '');\n    const validTag = /^[A-Za-z][A-Za-z0-9]$/.exec(tag);\n    const site = 'https://broadinstitute.github.io/picard/explain-flags.html';\n    return (_jsx(Dialog, { open: true, onClose: handleClose, title: \"Filter options\", children: _jsxs(DialogContent, { children: [_jsxs(Typography, { children: [\"Set filter bitmask options. Refer to \", _jsx(Link, { href: site, children: site }), ' ', \"for details\"] }), _jsx(Paper, { className: classes.paper, variant: \"outlined\", children: _jsxs(\"div\", { style: { display: 'flex' }, children: [_jsxs(\"div\", { children: [_jsx(Typography, { children: \"Read must have ALL these flags\" }), _jsx(Bitmask, { flag: flagInclude, setFlag: setFlagInclude })] }), _jsxs(\"div\", { children: [_jsx(Typography, { children: \"Read must have NONE of these flags\" }), _jsx(Bitmask, { flag: flagExclude, setFlag: setFlagExclude })] })] }) }), _jsxs(Paper, { className: classes.paper, variant: \"outlined\", children: [_jsx(Typography, { children: \"Filter by tag name and value. Use * in the value field to get all reads containing any value for that tag. Example: filter tag name SA with value * to get all split/supplementary reads. Other examples include HP for haplotype, or RG for read group\" }), _jsx(TextField, { className: classes.field, value: tag, onChange: event => {\n                                setTag(event.target.value);\n                            }, placeholder: \"Enter tag name\", error: tag.length === 2 && !validTag, helperText: tag.length === 2 && !validTag ? 'Not a valid tag' : '', slotProps: {\n                                htmlInput: {\n                                    maxLength: 2,\n                                },\n                            } }), _jsx(TextField, { className: classes.field, value: tagValue, onChange: event => {\n                                setTagValue(event.target.value);\n                            }, placeholder: \"Enter tag value\" })] }), _jsxs(Paper, { className: classes.paper, variant: \"outlined\", children: [_jsx(Typography, { children: \"Filter by read name\" }), _jsx(TextField, { className: classes.field, value: readName, onChange: event => {\n                                setReadName(event.target.value);\n                            }, placeholder: \"Enter read name\" })] }), _jsxs(DialogActions, { children: [_jsx(Button, { variant: \"contained\", color: \"primary\", autoFocus: true, type: \"submit\", onClick: () => {\n                                model.setFilterBy({\n                                    flagInclude,\n                                    flagExclude,\n                                    readName,\n                                    tagFilter: tag !== ''\n                                        ? {\n                                            tag,\n                                            value: tagValue,\n                                        }\n                                        : undefined,\n                                });\n                                handleClose();\n                            }, children: \"Submit\" }), _jsx(Button, { variant: \"contained\", color: \"secondary\", onClick: () => {\n                                handleClose();\n                            }, children: \"Cancel\" })] })] }) }));\n});\nexport default FilterByTagDialog;\n"],"names":["useStyles","makeStyles","theme","flagNames","Bitmask","props","flag","setFlag","_jsxs","_Fragment","_jsx","TextField","event","name","index","val","key","FilterByTagDialog","observer","_a","_b","model","handleClose","classes","filterBy","flagInclude","setFlagInclude","useState","flagExclude","setFlagExclude","tag","setTag","tagValue","setTagValue","readName","setReadName","validTag","site","Dialog","DialogContent","Typography","Link","Paper","DialogActions","Button"],"mappings":"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","x_google_ignoreList":[0]}