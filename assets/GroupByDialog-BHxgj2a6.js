import{o as B,a as l,u as c,h as E,j as e,c as f,D as F,T as v,d as $,e as G,B as L,f as N,i as q,n as T,p as C}from"./index-DUxFddIG.js";import{M as j}from"./MenuItem-BgPyIMvW.js";import"./dividerClasses-Dak6ZOU3.js";const R=B(function(I){const{model:r,handleClose:g}=I,[a,S]=l.useState(""),[o,w]=l.useState(),[A,m]=l.useState(!1),[D,x]=l.useState(),P=/^[A-Za-z][A-Za-z0-9]$/.exec(a),p=a.length===2&&!P,k=c.useDebounce(a,1e3),[d,b]=l.useState("");return l.useEffect(()=>{(async()=>{try{if(!p){x(void 0),m(!0);const t=await E({self:r,tag:k,blocks:c.getContainingView(r).staticBlocks});w(t)}}catch(t){console.error(t),x(t)}finally{m(!1)}})()},[r,p,k]),e.jsxs(f.Dialog,{open:!0,onClose:g,title:"Group by",children:[e.jsxs(F,{children:[e.jsx(v,{children:'NOTE: this will create new session tracks with the "filter by" set to the values chosen here rather than affecting the current track state'}),e.jsxs($,{fullWidth:!0,value:d,onChange:t=>{b(t.target.value)},label:"Group by...",select:!0,children:[e.jsx(j,{value:"strand",children:"Strand"}),e.jsx(j,{value:"tag",children:"Tag"})]}),d==="tag"?e.jsxs(e.Fragment,{children:[e.jsx(v,{color:"textSecondary",children:"Examples: HP for haplotype, RG for read group, etc."}),e.jsx($,{value:a,onChange:t=>{S(t.target.value)},placeholder:"Enter tag name",error:p,helperText:p?"Not a valid tag":"",autoComplete:"off","data-testid":"group-tag-name",slotProps:{htmlInput:{maxLength:2,"data-testid":"group-tag-name-input"}}}),D?e.jsx(f.ErrorMessage,{error:D}):A?e.jsx(f.LoadingEllipses,{message:"Loading unique tags"}):o?e.jsxs("div",{children:[e.jsxs("div",{children:["Found unique ",a," values:"]}),e.jsx("div",{children:o.join(", ")})]}):null]}):null]}),e.jsxs(G,{children:[e.jsx(L,{variant:"contained",color:"primary",type:"submit",disabled:!o,autoFocus:!0,onClick:()=>{const t=c.getContainingTrack(r),s=structuredClone(N(t.configuration)),y=c.getSession(r),h=c.getContainingView(r);if(d==="tag"){if(o){const i=[...o,void 0];for(const n of i){const u=`${s.trackId}-${a}:${n}-${Date.now()}-sessionTrack`;y.addTrackConf({...s,trackId:u,name:`${s.name} (${a}:${n})`,displays:[{displayId:`${u}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${u}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:{...q,tagFilter:{tag:a,value:n}}}}]}),h.showTrack(u)}}}else if(d==="strand"){const i=`${s.trackId}-${a}:(-)-${Date.now()}-sessionTrack`,n=`${s.trackId}-${a}:(+)-${Date.now()}-sessionTrack`;y.addTrackConf({...s,trackId:i,name:`${s.name} (-)`,displays:[{displayId:`${i}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${i}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:T}},{displayId:`${i}-LinearSNPCoverageDisplay`,type:"LinearSNPCoverageDisplay",filterBy:T}]}),y.addTrackConf({...s,trackId:n,name:`${s.name} (+)`,displays:[{displayId:`${n}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${n}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:C}},{displayId:`${n}-LinearSNPCoverageDisplay`,type:"LinearSNPCoverageDisplay",filterBy:C}]}),h.showTrack(i),h.showTrack(n)}g()},children:"Submit"}),e.jsx(L,{variant:"contained",color:"secondary",onClick:()=>{g()},children:"Cancel"})]})]})});export{R as default};
//# sourceMappingURL=GroupByDialog-BHxgj2a6.js.map
