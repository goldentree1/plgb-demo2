import{o as C,j as e,u as L,a as o,ac as X,U as B}from"./index-DUxFddIG.js";import{B as E}from"./BaseDisplayComponent-BTyusxhL.js";const S=C(function({model:t}){const j=L.getContainingView(t),a=Math.round(j.dynamicBlocks.totalWidthPx),l=t.drawCloud?t.height:t.layoutHeight,r=o.useRef(null),[c,h]=o.useState(null),[u,f]=o.useState(null),[g,b]=o.useState(null),i=o.useMemo(()=>t.featureLayout?X.from(t.featureLayout.data):null,[t.featureLayout]),M=o.useCallback(n=>{t.setRef(n)},[t,a,l]),F=o.useCallback(n=>{t.setMouseoverRef(n)},[t,a,l]),k=o.useCallback(n=>{if(!r.current||!i){h(null),f(null),b(null);return}const d=r.current.getBoundingClientRect(),x=n.clientX-d.left,p=n.clientY-d.top;b({x:n.clientX,y:n.clientY});const v=i.search(x,p,x+1,p+1);if(v.length>0){const y=v[0],s=t.featuresForFlatbush[y];s?(h({x:s.chainMinX,y:s.y1,width:s.chainMaxX-s.chainMinX,height:s.y2-s.y1}),f(s.data)):(h(null),f(null))}else h(null),f(null)},[i,t.featuresForFlatbush]),w=o.useCallback(()=>{h(null),f(null),b(null)},[]),R=o.useCallback(n=>{if(!r.current||!i)return;const d=r.current.getBoundingClientRect(),x=n.clientX-d.left,p=n.clientY-d.top,v=i.search(x,p,x+1,p+1);if(v.length>0){const y=v[0],s=t.featuresForFlatbush[y];s&&t.selectFeature(s.chain)}},[i,t]);return e.jsxs("div",{ref:r,style:{position:"relative",width:a,height:l},onMouseMove:k,onMouseLeave:w,onClick:R,children:[e.jsx("canvas",{"data-testid":t.drawCloud?"cloud-canvas":"stack-canvas",ref:M,style:{width:a,height:l,position:"absolute",left:0,top:0},width:a*2,height:l*2}),e.jsx("canvas",{"data-testid":"cloud-mouseover-canvas",ref:F,style:{width:a,height:l,position:"absolute",left:0,top:0,pointerEvents:"none"},width:a*2,height:l*2}),c?e.jsx("div",{style:{position:"absolute",left:c.x,top:c.y,width:c.width,height:c.height,backgroundColor:"rgba(0, 0, 0, 0.2)",pointerEvents:"none"}}):null,u&&g?e.jsx(B,{clientPoint:{x:g.x,y:g.y+20},placement:"bottom-start",children:e.jsxs("div",{children:[e.jsx("div",{children:e.jsx("strong",{children:u.name})}),e.jsxs("div",{children:[u.refName,":",u.start.toLocaleString(),"-",u.end.toLocaleString()]}),u.tlen!==0?e.jsxs("div",{children:["Template length: ",u.tlen]}):null]})}):null]})}),m=C(function({model:t}){return e.jsx(E,{model:t,children:e.jsx(S,{model:t})})});export{m as default};
//# sourceMappingURL=ReactComponent-C0ZBPEQV.js.map
