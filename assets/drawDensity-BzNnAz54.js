import{s,ag as O,R as S,u as T,aj as k}from"./index-DUxFddIG.js";const x=.3,y=2;function H(t,E){const{stopToken:g,features:u,regions:I,bpPerPx:d,scaleOpts:c,height:i,config:n}=E,C=I[0],M=s.readConfObject(n,"bicolorPivot"),N=s.readConfObject(n,"bicolorPivotValue"),R=s.readConfObject(n,"negColor"),b=s.readConfObject(n,"posColor"),V=s.readConfObject(n,"color"),F=s.readConfObject(n,"clipColor"),h=M!=="none"&&c.scaleType!=="log",_=O({...c,pivotValue:h?N:void 0,range:h?[R,"#eee",b]:["#eee",b]}),A=O({...c,range:[0,i]}),D=V==="#f0f"?(o,e)=>_(e):(o,e)=>s.readConfObject(n,"color",{feature:o,score:e}),m=A.domain(),P=m[0],v=m[1];let j=Number.NEGATIVE_INFINITY,p=!1;const w=[];let a=performance.now();for(const o of u.values()){performance.now()-a>400&&(S.checkStopToken(g),a=performance.now());const[e,f]=T.featureSpanPx(o,C,d);(Math.floor(e)!==Math.floor(j)||f-e>1)&&(w.push(o),j=e);const r=o.get("score");p=p||r>v||r<P;const l=f-e+x;r>=c.domain[0]?(t.fillStyle=D(o,r),t.fillRect(e,0,l,i)):(t.fillStyle="#eee",t.fillRect(e,0,l,i))}if(t.save(),p){t.fillStyle=F;for(const o of u.values()){performance.now()-a>400&&(S.checkStopToken(g),a=performance.now());const[e,f]=T.featureSpanPx(o,C,d),r=f-e+x,l=o.get("score");l>v?k(e,0,r,y,t):l<P&&c.scaleType!=="log"&&k(e,0,r,y,t)}}return t.restore(),{reducedFeatures:w}}export{H as drawDensity};
//# sourceMappingURL=drawDensity-BzNnAz54.js.map
