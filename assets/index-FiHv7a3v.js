var f=function(o,t,e,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!n:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(o,e):n?n.value=e:t.set(o,e),e},i=function(o,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!s:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(o):s?s.value:t.get(o)},h,l,r,a,d,_,m,p,c,Q,w,v,R,x,g;class U extends Map{constructor(t={}){if(super(),h.add(this),l.set(this,0),r.set(this,new Map),a.set(this,new Map),d.set(this,void 0),_.set(this,void 0),m.set(this,void 0),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof t.maxAge=="number"&&t.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");f(this,d,t.maxSize,"f"),f(this,_,t.maxAge||Number.POSITIVE_INFINITY,"f"),f(this,m,t.onEviction,"f")}get __oldCache(){return i(this,a,"f")}get(t){if(i(this,r,"f").has(t)){const e=i(this,r,"f").get(t);return i(this,h,"m",w).call(this,t,e)}if(i(this,a,"f").has(t)){const e=i(this,a,"f").get(t);if(!i(this,h,"m",c).call(this,t,e))return i(this,h,"m",x).call(this,t,e),e.value}}set(t,e,{maxAge:s=i(this,_,"f")}={}){const n=typeof s=="number"&&s!==Number.POSITIVE_INFINITY?Date.now()+s:void 0;return i(this,r,"f").has(t)?i(this,r,"f").set(t,{value:e,expiry:n}):i(this,h,"m",R).call(this,t,{value:e,expiry:n}),this}has(t){return i(this,r,"f").has(t)?!i(this,h,"m",c).call(this,t,i(this,r,"f").get(t)):i(this,a,"f").has(t)?!i(this,h,"m",c).call(this,t,i(this,a,"f").get(t)):!1}peek(t){if(i(this,r,"f").has(t))return i(this,h,"m",v).call(this,t,i(this,r,"f"));if(i(this,a,"f").has(t))return i(this,h,"m",v).call(this,t,i(this,a,"f"))}expiresIn(t){const e=i(this,r,"f").get(t)??i(this,a,"f").get(t);if(e)return e.expiry?e.expiry-Date.now():Number.POSITIVE_INFINITY}delete(t){var e;const s=i(this,r,"f").delete(t);return s&&f(this,l,(e=i(this,l,"f"),e--,e),"f"),i(this,a,"f").delete(t)||s}clear(){i(this,r,"f").clear(),i(this,a,"f").clear(),f(this,l,0,"f")}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...i(this,h,"m",g).call(this)],s=e.length-t;s<0?(f(this,r,new Map(e),"f"),f(this,a,new Map,"f"),f(this,l,e.length,"f")):(s>0&&i(this,h,"m",p).call(this,e.slice(0,s)),f(this,a,new Map(e.slice(s)),"f"),f(this,r,new Map,"f"),f(this,l,0,"f")),f(this,d,t,"f")}evict(t=1){const e=t;if(!e||e<=0)return;const s=[...i(this,h,"m",g).call(this)],n=Math.trunc(Math.min(e,Math.max(s.length-1,0)));n<=0||(i(this,h,"m",p).call(this,s.slice(0,n)),f(this,a,new Map(s.slice(n)),"f"),f(this,r,new Map,"f"),f(this,l,0,"f"))}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[(l=new WeakMap,r=new WeakMap,a=new WeakMap,d=new WeakMap,_=new WeakMap,m=new WeakMap,h=new WeakSet,p=function(e){if(typeof i(this,m,"f")=="function")for(const[s,n]of e)i(this,m,"f").call(this,s,n.value)},c=function(e,s){return typeof s.expiry=="number"&&s.expiry<=Date.now()?(typeof i(this,m,"f")=="function"&&i(this,m,"f").call(this,e,s.value),this.delete(e)):!1},Q=function(e,s){if(!i(this,h,"m",c).call(this,e,s))return s.value},w=function(e,s){return s.expiry?i(this,h,"m",Q).call(this,e,s):s.value},v=function(e,s){const n=s.get(e);return i(this,h,"m",w).call(this,e,n)},R=function(e,s){var n;i(this,r,"f").set(e,s),f(this,l,(n=i(this,l,"f"),n++,n),"f"),i(this,l,"f")>=i(this,d,"f")&&(f(this,l,0,"f"),i(this,h,"m",p).call(this,i(this,a,"f")),f(this,a,i(this,r,"f"),"f"),f(this,r,new Map,"f"))},x=function(e,s){i(this,a,"f").delete(e),i(this,h,"m",R).call(this,e,s)},g=function*(){for(const e of i(this,a,"f")){const[s,n]=e;i(this,r,"f").has(s)||i(this,h,"m",c).call(this,s,n)||(yield e)}for(const e of i(this,r,"f")){const[s,n]=e;i(this,h,"m",c).call(this,s,n)||(yield e)}},Symbol.iterator)](){for(const t of i(this,r,"f")){const[e,s]=t;i(this,h,"m",c).call(this,e,s)||(yield[e,s.value])}for(const t of i(this,a,"f")){const[e,s]=t;i(this,r,"f").has(e)||i(this,h,"m",c).call(this,e,s)||(yield[e,s.value])}}*entriesDescending(){let t=[...i(this,r,"f")];for(let e=t.length-1;e>=0;--e){const s=t[e],[n,u]=s;i(this,h,"m",c).call(this,n,u)||(yield[n,u.value])}t=[...i(this,a,"f")];for(let e=t.length-1;e>=0;--e){const s=t[e],[n,u]=s;i(this,r,"f").has(n)||i(this,h,"m",c).call(this,n,u)||(yield[n,u.value])}}*entriesAscending(){for(const[t,e]of i(this,h,"m",g).call(this))yield[t,e.value]}get size(){if(!i(this,l,"f"))return i(this,a,"f").size;let t=0;for(const e of i(this,a,"f").keys())i(this,r,"f").has(e)||t++;return Math.min(i(this,l,"f")+t,i(this,d,"f"))}get maxSize(){return i(this,d,"f")}get maxAge(){return i(this,_,"f")}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[s,n]of this.entriesAscending())t.call(e,n,s,this)}get[Symbol.toStringTag](){return"QuickLRU"}toString(){return`QuickLRU(${this.size}/${this.maxSize})`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}export{U as Q};
//# sourceMappingURL=index-FiHv7a3v.js.map
